---
{"dg-publish":true,"permalink":"/czc知识库/1-计算机/编程/python笔记/python模块：threading 和 multiprocessing/","dgPassFrontmatter":true,"created":"2024-12-07T08:39:46.941+08:00","updated":"2024-12-08T12:19:23.711+08:00"}
---




> [!NOTE] 文心一言：
> `threading` 和 `multiprocessing` 是 Python 中用于实现并发编程的两个重要模块，它们各自有着不同的工作机制和应用场景。
> 
> ### threading
> 
> `threading` 模块提供了基本的线程和锁的支持，允许程序在同一进程内并发执行多个任务。线程是操作系统能够进行运算调度的最小单位，它被包含在进程之中，是进程中的实际运作单位。
> 
> **优点**：
> 
> - 线程之间共享同一个进程的内存空间，因此数据共享和通信比较容易。
> - 创建线程的开销相对较小（相对于进程而言）。
> 
> **缺点**：
> 
> - 由于 Python 的全局解释器锁（GIL, Global Interpreter Lock）的存在，Python 线程无法真正并行执行 CPU 密集型任务。GIL 确保一次只有一个线程可以执行 Python 字节码，这限制了多线程在 CPU 密集型任务上的并行性。
> - 线程过多会导致频繁的上下文切换，增加系统开销。
> 
> **适用场景**：
> 
> - I/O 密集型任务（如文件读写、网络请求等）。
> - 需要利用多核CPU但又不全是CPU密集型任务的情况（如使用线程处理多个I/O任务）。
> 
> ### multiprocessing
> 
> `multiprocessing` 模块提供了对进程的管理，允许程序创建多个进程，并在不同的进程中执行不同的任务。进程是系统进行资源分配和调度的一个独立单元，是操作系统结构的基础。
> 
> **优点**：
> 
> - 进程之间是相互独立的，每个进程都有自己独立的内存空间，因此一个进程中的崩溃不会影响到其他进程。
> - 由于每个进程都拥有自己独立的Python解释器，所以Python的GIL不会影响多进程间的并行执行，可以真正利用多核CPU的优势。
> 
> **缺点**：
> 
> - 创建进程的开销较大，因为需要为每个进程分配独立的内存空间等资源。
> - 进程间通信（IPC）比较复杂，需要使用特定的机制（如管道、队列、共享内存等）来实现。
> 
> **适用场景**：
> 
> - CPU 密集型任务，可以充分利用多核CPU的计算能力。
> - 需要隔离的任务，例如某些任务可能因为某些原因崩溃，但又不希望影响整个应用程序。
> 
> ### 总结
> 
> - 对于I/O密集型任务，使用 `threading` 模块较为合适。
> - 对于CPU密集型任务，或者需要隔离的任务，使用 `multiprocessing` 模块更为合适。
> - 在实际开发中，可以根据任务的性质和需求来选择使用 `threading` 还是 `multiprocessing`，或者两者结合使用。例如，可以使用 `multiprocessing` 创建多个进程来处理CPU密集型任务，每个进程内部再使用 `threading` 来处理I/O密集型任务。